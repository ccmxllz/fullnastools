#!/bin/sh

PACKAGE_NAME="nastool"
PACKAGE_BASE="/var/packages/${PACKAGE_NAME}/target"
PACKAGE_SSS="/var/packages/${PACKAGE_NAME}/scripts/start-stop-status"
PYTHON_BIN="/var/packages/py3k/target/usr/local/bin/python3"
PYTHON_PACKAGE="/var/packages/py3k/target/usr/local/lib/python3.8/site-packages"

preinst ()
{
    exit 0
}

install_service(){
  chmod +x ${SYNOPKG_PKGDEST}/${ENGINE_SCRIPT}
  "${PYTHON_BIN}" "${PACKAGE_BASE}"/get-pip.py
  "${PYTHON_BIN}" -m pip install -r "${PACKAGE_BASE}"/requirements.txt
  echo "${PACKAGE_BASE}/" > "${PYTHON_PACKAGE}/nas-tools.pth"
}

postinst ()
{
  install_service
	exit 0
}

preuninst ()
{
    # 停用套件
    "${PACKAGE_SSS}" stop
    exit 0
}

postuninst ()
{

    exit 0
}

preupgrade ()
{
     # 停用套件
    "${PACKAGE_SSS}" stop
    exit 0
}

postupgrade ()
{
    install_service
    exit 0
}